"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { newObj[key] = obj[key]; } } } newObj.default = obj; return newObj; } }var _chunk2HSCQXHKjs = require('./chunk-2HSCQXHK.js');var _react = require('react');var _jssdkcore = require('@privy-io/js-sdk-core');var vr=e=>{let{user:r,client:c,setSiweState:a,siweState:o}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),n=_react.useCallback.call(void 0, l=>{var u;let y=_chunk2HSCQXHKjs.i.call(void 0, l);return a({status:"error",error:y}),(u=e==null?void 0:e.onError)==null||u.call(e,y),y},[e==null?void 0:e.onError]),t=_react.useCallback.call(void 0, f=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[f],function*({wallet:l,from:{domain:y,uri:u}}){var s;try{a({status:"generating-message"});let d=yield c.auth.siwe.init(l,y,u);return a({status:"awaiting-signature"}),(s=e==null?void 0:e.onGenerateMessage)==null||s.call(e,d.message),d.message}catch(d){throw n(d)}}),[c,n,e==null?void 0:e.onGenerateMessage]),i=_react.useCallback.call(void 0, u=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[u],function*({signature:l,messageOverride:y}){var f;try{if(!r)throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_link_siwe_before_logged_in",error:"Must be logged in to link a wallet, Use `useLoginWithSiwe` to login with a wallet"});a({status:"submitting-signature"});let s=yield c.auth.siwe.linkWithSiwe(l,void 0,y);return a({status:"done"}),(f=e==null?void 0:e.onSuccess)==null||f.call(e,s),s}catch(s){throw n(s)}}),[r,c,n,e==null?void 0:e.onSuccess]);return{generateSiweMessage:t,linkWithSiwe:i,state:o}};var Wr=e=>{let{user:r,client:c,setSiweState:a,siweState:o}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),n=_react.useCallback.call(void 0, l=>{var u;let y=_chunk2HSCQXHKjs.i.call(void 0, l);return a({status:"error",error:y}),(u=e==null?void 0:e.onError)==null||u.call(e,y),y},[e==null?void 0:e.onError]),t=_react.useCallback.call(void 0, f=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[f],function*({wallet:l,from:{domain:y,uri:u}}){var s;try{a({status:"generating-message"});let d=yield c.auth.siwe.init(l,y,u);return a({status:"awaiting-signature"}),(s=e==null?void 0:e.onGenerateMessage)==null||s.call(e,d.message),d.message}catch(d){throw n(d)}}),[c,n,e==null?void 0:e.onGenerateMessage]);return{loginWithSiwe:_react.useCallback.call(void 0, f=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[f],function*({signature:l,messageOverride:y,disableSignup:u}){var s;try{if(r)throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_login_with_siwe_while_already_logged_in",error:"Already logged in, use `useLinkWithSiwe` if you are trying to link a wallet to an existing account"});a({status:"submitting-signature"});let d=yield c.auth.siwe.loginWithSiwe(l,void 0,y,u?"no-signup":"login-or-sign-up");return a({status:"done"}),(s=e==null?void 0:e.onSuccess)==null||s.call(e,d.user,d.is_new_user),d.user}catch(d){throw n(d)}}),[r,c,n,e==null?void 0:e.onSuccess]),generateSiweMessage:t,state:o}};var Or=e=>{let{user:r,client:c}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),a=_react.useCallback.call(void 0, n=>{var i;let t=_chunk2HSCQXHKjs.i.call(void 0, n);return(i=e==null?void 0:e.onError)==null||i.call(e,t),t},[e==null?void 0:e.onError]);return{unlinkWallet:_react.useCallback.call(void 0, t=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[t],function*({address:n}){var i;try{if(!r)throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_unlink_siwe_before_logged_in",error:"Must be logged in to unlink a wallet, Use `useLoginWithSiwe` to login with a wallet"});let l=yield c.auth.siwe.unlinkWallet(n);return(i=e==null?void 0:e.onSuccess)==null||i.call(e,l),l}catch(l){throw a(l)}}),[r,c,a,e==null?void 0:e.onSuccess])}};var Gr=e=>{let[r,c]=_react.useState.call(void 0, ""),{user:a,client:o,otpState:n,setOtpState:t}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),i=_react.useCallback.call(void 0, u=>{var s;let f=_chunk2HSCQXHKjs.i.call(void 0, u);return t({status:"error",error:f}),(s=e==null?void 0:e.onError)==null||s.call(e,f),f},[e==null?void 0:e.onError]),l=_react.useCallback.call(void 0, f=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[f],function*({email:u}){var s;c(u);try{t({status:"sending-code"});let d=yield o.auth.email.sendCode(u);return t({status:"awaiting-code-input"}),(s=e==null?void 0:e.onSendCodeSuccess)==null||s.call(e,{email:u}),d}catch(d){return i(d),{success:!1}}}),[o,i,e==null?void 0:e.onSendCodeSuccess]),y=_react.useCallback.call(void 0, s=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[s],function*({code:u,email:f}){var d;try{if(!a)throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_link_email_before_logged_in",error:"Must be logged in to link an email, Use `useLoginWithEmail` to login with email"});let v=f||r;if(!v)throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_submit_otp_before_sending",error:"Must `sendCode` with a valid email before calling `linkWithCode`"});t({status:"submitting-code"});let k=yield o.auth.email.linkWithCode(v,u);return t({status:"done"}),(d=e==null?void 0:e.onLinkSuccess)==null||d.call(e,k),k}catch(v){i(v)}}),[a,o,r,i,e==null?void 0:e.onLinkSuccess]);return{sendCode:l,linkWithCode:y,state:n}};var Jr=e=>{let[r,c]=_react.useState.call(void 0, ""),{user:a,client:o,otpState:n,setOtpState:t}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),i=_react.useCallback.call(void 0, u=>{var s;let f=_chunk2HSCQXHKjs.i.call(void 0, u);return t({status:"error",error:f}),(s=e==null?void 0:e.onError)==null||s.call(e,f),f},[e==null?void 0:e.onError]),l=_react.useCallback.call(void 0, f=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[f],function*({email:u}){var s;c(u);try{t({status:"sending-code"});let d=yield o.auth.email.sendCode(u);return t({status:"awaiting-code-input"}),(s=e==null?void 0:e.onSendCodeSuccess)==null||s.call(e,{email:u}),d}catch(d){return i(d),{success:!1}}}),[o,i,e==null?void 0:e.onSendCodeSuccess]),y=_react.useCallback.call(void 0, d=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[d],function*({code:u,email:f,disableSignup:s}){var v;try{if(a)throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_login_with_email_while_already_logged_in",error:"Already logged in, use `useLinkWithEmail` if you are trying to link an email to an existing account"});let k=f||r;if(!k)throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_submit_otp_before_sending",error:"Must `sendCode` with a valid email before calling `loginWithCode`"});t({status:"submitting-code"});let w=yield o.auth.email.loginWithCode(k,u,s?"no-signup":"login-or-sign-up");return t({status:"done"}),(v=e==null?void 0:e.onLoginSuccess)==null||v.call(e,w.user,w.is_new_user),w==null?void 0:w.user}catch(k){i(k)}}),[a,o,r,i,e==null?void 0:e.onLoginSuccess]);return{sendCode:l,loginWithCode:y,state:n}};var Zr=e=>{let[r,c]=_react.useState.call(void 0, ""),{user:a,client:o,otpState:n,setOtpState:t}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),i=_react.useCallback.call(void 0, u=>{var s;let f=_chunk2HSCQXHKjs.i.call(void 0, u);return t({status:"error",error:f}),(s=e==null?void 0:e.onError)==null||s.call(e,f),f},[e==null?void 0:e.onError]),l=_react.useCallback.call(void 0, f=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[f],function*({phone:u}){var s;c(u);try{t({status:"sending-code"});let d=yield o.auth.phone.sendCode(u);return t({status:"awaiting-code-input"}),(s=e==null?void 0:e.onSendCodeSuccess)==null||s.call(e,{phone:u}),d}catch(d){return i(d),{success:!1}}}),[o,i,e==null?void 0:e.onSendCodeSuccess]),y=_react.useCallback.call(void 0, s=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[s],function*({code:u,phone:f}){var d;try{if(!a)throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_link_sms_before_logged_in",error:"Must be logged in to link a phone number, Use `useLoginWithSMS` to login with a phone number"});if(!(f||r))throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_submit_otp_before_sending",error:"Must `sendCode` with a valid phone number before calling `linkWithCode`"});t({status:"submitting-code"});let k=yield o.auth.phone.linkWithCode(f||r,u);return t({status:"done"}),(d=e==null?void 0:e.onLinkSuccess)==null||d.call(e,k),k}catch(v){i(v)}}),[a,o,r,i,e==null?void 0:e.onLinkSuccess]);return{sendCode:l,linkWithCode:y,state:n}};var at=e=>{let[r,c]=_react.useState.call(void 0, ""),{user:a,client:o,otpState:n,setOtpState:t}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),i=_react.useCallback.call(void 0, u=>{var s;let f=_chunk2HSCQXHKjs.i.call(void 0, u);return t({status:"error",error:f}),(s=e==null?void 0:e.onError)==null||s.call(e,f),f},[e==null?void 0:e.onError]),l=_react.useCallback.call(void 0, f=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[f],function*({phone:u}){var s;c(u);try{t({status:"sending-code"});let d=yield o.auth.phone.sendCode(u);return t({status:"awaiting-code-input"}),(s=e==null?void 0:e.onSendCodeSuccess)==null||s.call(e,{phone:u}),d}catch(d){return i(d),{success:!1}}}),[o,i,e==null?void 0:e.onSendCodeSuccess]),y=_react.useCallback.call(void 0, d=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[d],function*({code:u,phone:f,disableSignup:s}){var v;try{if(a)throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_login_with_sms_while_already_logged_in",error:"Already logged in, use `useLinkWithSMS` if you are trying to link a phone number to an existing account"});if(!(f||r))throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_submit_otp_before_sending",error:"Must `sendCode` with a valid phone number before calling `loginWithCode`"});t({status:"submitting-code"});let w=yield o.auth.phone.loginWithCode(f||r,u,s?"no-signup":"login-or-sign-up");return t({status:"done"}),(v=e==null?void 0:e.onLoginSuccess)==null||v.call(e,w.user,w.is_new_user),w==null?void 0:w.user}catch(k){i(k)}}),[a,o,r,i,e==null?void 0:e.onLoginSuccess]);return{sendCode:l,loginWithCode:y,state:n}};var _expolinking = require('expo-linking'); var O = _interopRequireWildcard(_expolinking); var A = _interopRequireWildcard(_expolinking);var ht=e=>{let{appState:r,getCurrentAppState:c}=_chunk2HSCQXHKjs.k.call(void 0, ),{client:a,user:o,farcasterState:n,setFarcasterState:t}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),i=_react.useRef.call(void 0, !1),l=_react.useCallback.call(void 0, f=>{var d;let s=_chunk2HSCQXHKjs.i.call(void 0, f);return t({status:"error",error:s}),(d=e==null?void 0:e.onError)==null||d.call(e,s),s},[e==null?void 0:e.onError,t]),y=_react.useCallback.call(void 0, ()=>{i.current=!0},[]);return{linkWithFarcaster:_react.useCallback.call(void 0, (v,...k)=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[v,...k],function*({relyingParty:f,redirectUrl:s},d={pollAttempts:10,pollIntervalMs:1e3}){var w;try{if(i.current=!1,!o)throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_link_farcaster_before_logged_in",error:"Must be logged in to link a Farcaster account."});t({status:"generating-uri"});let{connect_uri:b,channel_token:S}=yield a.auth.farcaster.initializeAuth({relyingParty:f,redirectUrl:O.createURL(s!=null?s:"/")});if(!b)throw new (0, _jssdkcore.PrivyClientError)({code:"failed_to_generate_farcaster_uri",error:"Failed to generate farcaster uri"});if(!S)throw new (0, _jssdkcore.PrivyClientError)({code:"failed_to_generate_farcaster_channel_token",error:"Failed to generate farcaster channel token"});yield O.openURL(b),t({status:"polling-status"});let E=0;for(;E<d.pollAttempts;){if(i.current)throw new (0, _jssdkcore.PrivyClientError)({code:"farcaster_polling_canceled",error:"Farcaster polling canceled"});if(r.current!=="active"&&c()!=="active"){yield _chunk2HSCQXHKjs.j.call(void 0, d.pollIntervalMs);continue}let W=yield a.auth.farcaster.getFarcasterStatus({channel_token:S});if(W.state==="completed"){t({status:"submitting-token"});let P=yield a.auth.farcaster.link(_chunk2HSCQXHKjs.a.call(void 0, {channel_token:S},W));return t({status:"done"}),(w=e==null?void 0:e.onSuccess)==null||w.call(e,P),P}E++,yield _chunk2HSCQXHKjs.j.call(void 0, d.pollIntervalMs)}throw new (0, _jssdkcore.PrivyClientError)({code:"farcaster_polling_timeout",error:"Farcasting polling timed out"})}catch(b){throw l(b)}}),[a,e==null?void 0:e.onSuccess,l,t,o]),state:n,cancel:y}};var kt=e=>{let{client:r}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),c=_react.useCallback.call(void 0, o=>{var t;let n=_chunk2HSCQXHKjs.i.call(void 0, o);return(t=e==null?void 0:e.onError)==null||t.call(e,n),n},[e==null?void 0:e.onError]);return{unlinkFarcaster:_react.useCallback.call(void 0, n=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[n],function*({fid:o}){var t;try{let i=yield r.auth.farcaster.unlink({fid:o});return(t=e==null?void 0:e.onSuccess)==null||t.call(e,i),i}catch(i){throw c(i)}}),[r,e==null?void 0:e.onSuccess,c])}};var Pt=e=>{let{appState:r,getCurrentAppState:c}=_chunk2HSCQXHKjs.k.call(void 0, ),{client:a,user:o,farcasterState:n,setFarcasterState:t}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),i=_react.useRef.call(void 0, !1),l=_react.useCallback.call(void 0, f=>{var d;let s=_chunk2HSCQXHKjs.i.call(void 0, f);return t({status:"error",error:s}),(d=e==null?void 0:e.onError)==null||d.call(e,s),s},[e==null?void 0:e.onError,t]),y=_react.useCallback.call(void 0, ()=>{i.current=!0},[]);return{loginWithFarcaster:_react.useCallback.call(void 0, (k,...w)=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[k,...w],function*({relyingParty:f,redirectUrl:s,disableSignup:d},v={pollAttempts:10,pollIntervalMs:1e3}){var b;try{if(i.current=!1,o)throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_login_with_farcaster_while_already_logged_in",error:"Already logged in, use `useLinkWithFarcaster` if you are trying to link farcaster to an existing account"});t({status:"generating-uri"});let{connect_uri:S,channel_token:E}=yield a.auth.farcaster.initializeAuth({relyingParty:f,redirectUrl:A.createURL(s!=null?s:"/")});if(!S)throw new (0, _jssdkcore.PrivyClientError)({code:"failed_to_generate_farcaster_uri",error:"Failed to generate farcaster uri"});if(!E)throw new (0, _jssdkcore.PrivyClientError)({code:"failed_to_generate_farcaster_channel_token",error:"Failed to generate farcaster channel token"});yield A.openURL(S),t({status:"polling-status"});let W=0;for(;W<v.pollAttempts;){if(i.current)throw new (0, _jssdkcore.PrivyClientError)({code:"farcaster_polling_canceled",error:"Farcaster polling canceled"});if(r.current!=="active"&&c()!=="active"){yield _chunk2HSCQXHKjs.j.call(void 0, v.pollIntervalMs);continue}let P=yield a.auth.farcaster.getFarcasterStatus({channel_token:E});if(P.state==="completed"){t({status:"submitting-token"});let F=yield a.auth.farcaster.authenticate(_chunk2HSCQXHKjs.a.call(void 0, {channel_token:E,mode:d?"no-signup":"login-or-sign-up"},P));return t({status:"done"}),(b=e==null?void 0:e.onSuccess)==null||b.call(e,F.user,F.is_new_user),F.user}W++,yield _chunk2HSCQXHKjs.j.call(void 0, v.pollIntervalMs)}throw new (0, _jssdkcore.PrivyClientError)({code:"farcaster_polling_timeout",error:"Farcasting polling timed out"})}catch(S){throw l(S)}}),[a,l,e==null?void 0:e.onSuccess,t,o,r]),state:n,cancel:y}};var Ot=e=>{let{client:r}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),c=_react.useCallback.call(void 0, o=>{var t;let n=_chunk2HSCQXHKjs.i.call(void 0, o);return(t=e==null?void 0:e.onError)==null||t.call(e,n),n},[e==null?void 0:e.onError]);return{unlinkOAuth:_react.useCallback.call(void 0, t=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[t],function*({provider:o,subject:n}){var i;try{let l=yield r.auth.oauth.unlink(o,n);return(i=e==null?void 0:e.onSuccess)==null||i.call(e,l),l}catch(l){throw c(l)}}),[r,e==null?void 0:e.onSuccess,c])}};var Tt=e=>{let{client:r}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),c=_react.useRef.call(void 0, e.onOAuthTokenGrant);c.current=e.onOAuthTokenGrant,_react.useEffect.call(void 0, ()=>{let{unsubscribe:a}=r.addOAuthTokensListener(o=>{c.current(o)});return a},[r])};var Kt=()=>{let{user:e,client:r}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F);return{setRecovery:_react.useCallback.call(void 0, a=>_chunk2HSCQXHKjs.d.call(void 0, void 0,null,function*(){var i;let o=r.app.appId;if(!e)throw new (0, _jssdkcore.PrivyClientError)({code:"embedded_wallet_recovery_error",error:"User must be loaded before attempting to modify the recovery method."});let n=(i=_jssdkcore.getUserEmbeddedEthereumWallet.call(void 0, e))!=null?i:_jssdkcore.getUserEmbeddedSolanaWallet.call(void 0, e);if(!n)throw new (0, _jssdkcore.PrivyClientError)({code:"embedded_wallet_does_not_exist",error:"Embedded wallet does not exist"});try{n.chain_type==="ethereum"?yield r.embeddedWallet.getProvider(n):n.chain_type==="solana"&&(yield r.embeddedWallet.getSolanaProvider(n,n.address,"solana-address-verifier"))}catch(l){throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_to_set_password_before_connected",error:"Embedded wallet must be connected before setting password"})}_jssdkcore.throwIfInvalidRecoveryUpgradePath.call(void 0, {currentRecoveryMethod:n.recovery_method,upgradeToRecoveryMethod:a.recoveryMethod});let t=yield Ve({appId:o,client:r,user:e,primaryAccount:n,recoveryParams:a});try{let{user:l}=yield r.embeddedWallet.setRecovery(t);return{user:l}}catch(l){throw new (0, _jssdkcore.PrivyClientError)({code:"embedded_wallet_set_recovery_error",error:l instanceof Error?l.message:"Error setting password on embedded wallet"})}}),[r,e])}},Ve=n=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[n],function*({appId:e,client:r,user:c,primaryAccount:a,recoveryParams:o}){switch(o.recoveryMethod){case"user-passcode":return _chunk2HSCQXHKjs.b.call(void 0, _chunk2HSCQXHKjs.a.call(void 0, {},o),{wallet:a});case"google-drive":{let t=yield _chunk2HSCQXHKjs.l.call(void 0, r);return{recoveryMethod:"google-drive",wallet:a,recoveryAccessToken:t}}case"icloud":{let{recoverySecret:t,iCloudRecordName:i}=yield _chunk2HSCQXHKjs.g.call(void 0, {appId:e,client:r,user:c});return{recoveryMethod:"icloud-native",recoverySecretOverride:t,iCloudRecordNameOverride:i,wallet:a}}default:throw new (0, _jssdkcore.PrivyClientError)({code:"embedded_wallet_recovery_error",error:"Unrecognized recovery method"})}});var Yt=()=>{let{user:e,client:r}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F);return{recover:_react.useCallback.call(void 0, a=>_chunk2HSCQXHKjs.d.call(void 0, void 0,null,function*(){var l;if(!e)throw new (0, _jssdkcore.PrivyClientError)({code:"embedded_wallet_recovery_error",error:"User must be loaded before attempting to modify the recovery method."});let o=(l=_jssdkcore.getUserEmbeddedEthereumWallet.call(void 0, e))!=null?l:_jssdkcore.getUserEmbeddedSolanaWallet.call(void 0, e);if(!o)throw new (0, _jssdkcore.PrivyClientError)({code:"embedded_wallet_does_not_exist",error:"Embedded wallet does not exist"});let n,t,i;switch(a.recoveryMethod){case"user-passcode":n=a.password;break;case"google-drive":t=yield _chunk2HSCQXHKjs.l.call(void 0, r);break;case"icloud":let{recoverySecret:y}=yield _chunk2HSCQXHKjs.h.call(void 0, {client:r,walletAddress:o.address,chainType:o.chain_type});i=y;break}try{o.chain_type==="ethereum"?yield r.embeddedWallet.getProvider(o,n,t,i):o.chain_type==="solana"&&(yield r.embeddedWallet.getSolanaProvider(o,o.address,"solana-address-verifier",n,t,i))}catch(y){throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_to_set_password_before_connected",error:"Embedded wallet must be connected before setting password"})}}),[r,e])}};var z=(e={})=>{let{wallet:r,createWalletCallbacks:c,recoverWalletCallbacks:a,setWalletRecoveryCallbacks:o}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),{onCreateWalletSuccess:n,onCreateWalletError:t,onRecoverWalletError:i,onRecoverWalletSuccess:l,onSetWalletRecoverySuccess:y,onSetWalletRecoveryError:u}=e;return _react.useEffect.call(void 0, ()=>{c.current={onSuccess:n,onError:t}},[n,t]),_react.useEffect.call(void 0, ()=>{a.current={onSuccess:l,onError:i}},[l,i]),_react.useEffect.call(void 0, ()=>{o.current={onSuccess:y,onError:u}},[l,i]),r};var ao=({onStateChange:e})=>{let r=z();return _react.useEffect.call(void 0, ()=>{e(r)},[r])};var uo=()=>{let{getIdentityToken:e}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F);return{getIdentityToken:e}};var wo=e=>{let{user:r,client:c}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),a=_react.useCallback.call(void 0, n=>{var i;let t=_chunk2HSCQXHKjs.i.call(void 0, n);return(i=e==null?void 0:e.onError)==null||i.call(e,t),t},[e==null?void 0:e.onError]);return{create:_react.useCallback.call(void 0, ()=>_chunk2HSCQXHKjs.d.call(void 0, void 0,null,function*(){var n;try{if(r)throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_to_create_guest_account_for_logged_in_user",error:"Already logged in, you cannot create a guest account"});let t=yield c.auth.guest.create();return(n=e==null?void 0:e.onSuccess)==null||n.call(e,t.user,t.is_new_user),t.user}catch(t){throw a(t)}}),[c,a,r,e==null?void 0:e.onSuccess])}};function Eo({onMfaRequired:e}){let{client:r,user:c}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F);_react.useEffect.call(void 0, ()=>{function a(){return _chunk2HSCQXHKjs.d.call(void 0, this,null,function*(){var o;yield e((o=c==null?void 0:c.mfa_methods.map(({type:n})=>n))!=null?o:[])})}return r.mfaPromises.on("mfaRequired",a),()=>{r.mfaPromises.off("mfaRequired",a)}},[r,c,e])}function Uo(){let{client:e,mfaConfig:r}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),c=_react.useCallback.call(void 0, n=>_chunk2HSCQXHKjs.d.call(void 0, this,null,function*(){switch(n.method){case"sms":yield e.mfa.sms.sendCode({action:"verify"});return;case"passkey":let{options:t}=yield e.mfa.passkey.generateAuthenticationOptions({relying_party:n.relyingParty||(r==null?void 0:r.relyingParty)});return _chunk2HSCQXHKjs.L.call(void 0, t);case"totp":return;default:throw new Error(`Unsupported MFA method: ${n.mfaMethod}`)}}),[e,r==null?void 0:r.relyingParty]),a=_react.useCallback.call(void 0, n=>_chunk2HSCQXHKjs.d.call(void 0, this,null,function*(){var t,i,l;switch(n.method){case"totp":case"sms":if(typeof n.mfaCode!="string")throw new (0, _jssdkcore.PrivyClientError)({code:"invalid_mfa_code",error:"Invalid MFA code"});(t=e.mfaPromises.rootPromise.current)==null||t.resolve({mfaMethod:n.method,mfaCode:n.mfaCode,relyingParty:n.relyingParty||(r==null?void 0:r.relyingParty)||""}),yield new Promise((s,d)=>{e.mfaPromises.submitPromise.current={resolve:s,reject:d}});break;case"passkey":if(typeof n.mfaCode=="string")throw new (0, _jssdkcore.PrivyClientError)({code:"invalid_passkey_response",error:"Invalid authenticator response"});let y=yield _chunk2HSCQXHKjs.J.call(void 0, n.mfaCode),u=_chunk2HSCQXHKjs.K.call(void 0, y);(i=e.mfaPromises.rootPromise.current)==null||i.resolve({mfaMethod:n.method,relyingParty:n.relyingParty||"",mfaCode:u}),yield new Promise((s,d)=>{e.mfaPromises.submitPromise.current={resolve:s,reject:d}});break;default:let f=new (0, _jssdkcore.PrivyClientError)({code:"unsupported_mfa_method",error:"Unsupported MFA method"});throw(l=e.mfaPromises.rootPromise.current)==null||l.reject(f),f}}),[e,r==null?void 0:r.relyingParty]),o=_react.useCallback.call(void 0, ()=>{var n;(n=e.mfaPromises.rootPromise.current)==null||n.reject(new (0, _jssdkcore.PrivyClientError)({code:"mfa_canceled",error:"MFA canceled"}))},[e]);return{init:c,submit:a,cancel:o}}function Ro(){let{client:e}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),r=_react.useCallback.call(void 0, o=>_chunk2HSCQXHKjs.d.call(void 0, this,null,function*(){switch(o.method){case"sms":case"totp":return yield e.mfa.initEnrollMfa(o);case"passkey":return;default:throw new Error(`Unsupported MFA method: ${o.mfaMethod}`)}}),[e]),c=_react.useCallback.call(void 0, o=>_chunk2HSCQXHKjs.d.call(void 0, this,null,function*(){switch(o.method){case"sms":case"totp":case"passkey":yield e.mfa.submitEnrollMfa(o);return;default:throw new Error(`Unsupported MFA method: ${o.mfaMethod}`)}}),[e]),a=_react.useCallback.call(void 0, o=>_chunk2HSCQXHKjs.d.call(void 0, this,null,function*(){switch(o.method){case"sms":case"totp":yield e.mfa.unenrollMfa(o.method);return;case"passkey":yield e.mfa.submitEnrollMfa({method:"passkey",credentialIds:[]});return;default:throw new Error(`Unsupported MFA method: ${o.method}`)}}),[e]);return{initMfaEnrollment:r,submitMfaEnrollment:c,unenrollMfa:a}}var cr=(e={})=>{let{solanaWallet:r,createSolanaWalletCallbacks:c,recoverSolanaWalletCallbacks:a}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),{onCreateWalletSuccess:o,onCreateWalletError:n,onRecoverWalletError:t,onRecoverWalletSuccess:i}=e;return _react.useEffect.call(void 0, ()=>{c.current={onSuccess:o,onError:n}},[o,n]),_react.useEffect.call(void 0, ()=>{a.current={onSuccess:i,onError:t}},[i,t]),r};var Y=()=>{let{user:e,isReady:r,logout:c,getAccessToken:a,error:o}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F);return{user:e,isReady:r,error:o,logout:c,getAccessToken:a}};var Z=()=>{let{client:e}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F);return e};var hr=()=>{let{user:e}=Y(),r=Z(),c=_react.useMemo.call(void 0, ()=>{var l;let o=(l=_jssdkcore.getUserEmbeddedEthereumWallet.call(void 0, e))!=null?l:_jssdkcore.getUserEmbeddedSolanaWallet.call(void 0, e);if(!o)return[];let n=_jssdkcore.getAllUserEmbeddedBitcoinWallets.call(void 0, e),{entropyId:t,entropyIdVerifier:i}=_chunk2HSCQXHKjs.f.call(void 0, o);return n.map(y=>({address:y.address,walletIndex:y.wallet_index,publicKey:y.public_key,chainType:y.chain_type,getProvider:()=>r.embeddedWallet.getBitcoinProvider({wallet:y,entropyId:t,entropyIdVerifier:i})}))},[r,e]),a=_react.useCallback.call(void 0, t=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[t],function*({chainType:o,createAdditional:n=!1}){var k;let{user:i}=yield r.user.get(),l=(k=_jssdkcore.getUserEmbeddedEthereumWallet.call(void 0, i))!=null?k:_jssdkcore.getUserEmbeddedSolanaWallet.call(void 0, i);if(!l)throw new (0, _jssdkcore.PrivyClientError)({code:"embedded_wallet_creation_error",error:"No existing wallet for this user, create an Ethereum walet first to add a Bitcoin wallet"});let{entropyId:y,entropyIdVerifier:u}=_chunk2HSCQXHKjs.f.call(void 0, l),f=_jssdkcore.getAllUserEmbeddedBitcoinWallets.call(void 0, i).filter(w=>w.chain_type===o);if(!n&&f.length>0)throw new (0, _jssdkcore.PrivyClientError)({code:"embedded_wallet_creation_error",error:"Wallet already exists for this user. Set `createAdditional` to `true` to create another wallet"});let s=f.length===0?0:Math.max(...f.map(w=>w.wallet_index),0)+1,d=yield r.embeddedWallet.add({chainType:o,hdWalletIndex:s,entropyId:y,entropyIdVerifier:u}),v=_jssdkcore.getAllUserEmbeddedBitcoinWallets.call(void 0, d.user).find(w=>w.chain_type===o&&w.wallet_index===s);if(!d.user||!v)throw new (0, _jssdkcore.PrivyClientError)({code:"embedded_wallet_creation_error",error:"Unknown error creating wallet"});return{user:d.user,provider:yield r.embeddedWallet.getBitcoinProvider({wallet:v,entropyId:y,entropyIdVerifier:u})}}),[r]);return{wallets:c,create:a}};exports.a = vr; exports.b = Wr; exports.c = Or; exports.d = Gr; exports.e = Jr; exports.f = Zr; exports.g = at; exports.h = ht; exports.i = kt; exports.j = Pt; exports.k = Ot; exports.l = Tt; exports.m = Kt; exports.n = Yt; exports.o = z; exports.p = ao; exports.q = uo; exports.r = wo; exports.s = Eo; exports.t = Uo; exports.u = Ro; exports.v = cr; exports.w = Y; exports.x = Z; exports.y = hr;
