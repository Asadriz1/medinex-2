"use strict";Object.defineProperty(exports, "__esModule", {value: true});var _chunkQSWCX5XIjs = require('./chunk-QSWCX5XI.js');var _chunk2HSCQXHKjs = require('./chunk-2HSCQXHK.js');var _react = require('react');var _jssdkcore = require('@privy-io/js-sdk-core');var G=e=>{let{user:m,client:i,passkeyState:P,setPasskeyState:s}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),u=_react.useCallback.call(void 0, a=>{var n;let o=_chunk2HSCQXHKjs.i.call(void 0, a);return s({status:"error",error:o}),(n=e==null?void 0:e.onError)==null||n.call(e,o),o},[e==null?void 0:e.onError]);return{linkWithPasskey:_react.useCallback.call(void 0, o=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[o],function*({relyingParty:a}){var n,l,y,k,r,d,c,f,p;try{if(!m)throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_link_passkey_before_logged_in",error:"Must be logged in to link a passkey."});s({status:"generating-challenege"});let{options:t}=yield i.auth.passkey.generateRegistrationOptions(a);s({status:"awaiting-passkey"});let W=yield _chunk2HSCQXHKjs.I.call(void 0, {rp:t.rp,user:{id:t.user.id,name:t.user.name,displayName:t.user.display_name},challenge:t.challenge,pubKeyCredParams:t.pub_key_cred_params,extensions:{hmacCreateSecret:(n=t.extensions)==null?void 0:n.hmac_create_secret,credProps:(y=(l=t.extensions)==null?void 0:l.cred_props)==null?void 0:y.rk,appid:(k=t.extensions)==null?void 0:k.app_id},attestation:t.attestation,excludeCredentials:t.exclude_credentials,authenticatorSelection:{authenticatorAttachment:(r=t.authenticator_selection)==null?void 0:r.authenticator_attachment,residentKey:(d=t.authenticator_selection)==null?void 0:d.resident_key,userVerification:(c=t.authenticator_selection)==null?void 0:c.user_verification,requireResidentKey:(f=t.authenticator_selection)==null?void 0:f.require_resident_key}});s({status:"submitting-response"});let w=yield i.auth.passkey.linkWithPasskey(W,a);return s({status:"done"}),(p=e==null?void 0:e.onSuccess)==null||p.call(e,w),w}catch(t){throw u(t)}}),[m,i,u,e==null?void 0:e.onSuccess]),state:P}};var ee=e=>{let{user:m,client:i,passkeyState:P,setPasskeyState:s}=_react.useContext.call(void 0, _chunk2HSCQXHKjs.F),u=_react.useCallback.call(void 0, a=>{var n;let o=_chunk2HSCQXHKjs.i.call(void 0, a);return s({status:"error",error:o}),(n=e==null?void 0:e.onError)==null||n.call(e,o),o},[e==null?void 0:e.onError]);return{loginWithPasskey:_react.useCallback.call(void 0, o=>_chunk2HSCQXHKjs.d.call(void 0, void 0,[o],function*({relyingParty:a}){var n,l,y,k;try{if(m)throw new (0, _jssdkcore.PrivyClientError)({code:"attempted_login_with_passkey_while_already_logged_in",error:"Already logged in, use `useLinkWithPasskey` if you are trying to link a passkey to an existing account"});s({status:"generating-challenege"});let{options:r}=yield i.auth.passkey.generateAuthenticationOptions(a);s({status:"awaiting-passkey"});let d=yield _chunk2HSCQXHKjs.J.call(void 0, {challenge:r.challenge,rpId:r.rp_id,extensions:{appid:(n=r.extensions)==null?void 0:n.app_id,credProps:(l=r.extensions)==null?void 0:l.cred_props,hmacCreateSecret:(y=r.extensions)==null?void 0:y.hmac_create_secret},timeout:r.timeout,allowCredentials:r.allow_credentials,userVerification:r.user_verification});s({status:"submitting-response"});let c=yield i.auth.passkey.loginWithPasskey(_chunk2HSCQXHKjs.b.call(void 0, _chunk2HSCQXHKjs.a.call(void 0, {},d),{clientExtensionResults:{}}),r.challenge,a);return s({status:"done"}),(k=e==null?void 0:e.onSuccess)==null||k.call(e,c.user,c.is_new_user),c.user}catch(r){throw u(r)}}),[i,u,e==null?void 0:e.onSuccess]),state:P}};exports.hasError = _chunkQSWCX5XIjs.g; exports.isConnected = _chunkQSWCX5XIjs.a; exports.isConnecting = _chunkQSWCX5XIjs.c; exports.isCreating = _chunkQSWCX5XIjs.f; exports.isDisconnected = _chunkQSWCX5XIjs.d; exports.isNotCreated = _chunkQSWCX5XIjs.e; exports.isReconnecting = _chunkQSWCX5XIjs.b; exports.needsRecovery = _chunkQSWCX5XIjs.h; exports.useLinkWithPasskey = G; exports.useLoginWithPasskey = ee;
